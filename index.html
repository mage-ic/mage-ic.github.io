<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>待办事项管理</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#4F46E5', // 深紫蓝色作为主色调
                        secondary: '#818CF8', // 淡紫色作为辅助色
                        accent: '#EF4444', // 红色作为强调色
                        success: '#10B981', // 绿色表示完成状态
                    },
                    fontFamily: {
                        inter: ['Inter', 'system-ui', 'sans-serif'],
                    },
                    boxShadow: {
                        'task': '0 2px 8px rgba(0, 0, 0, 0.08)',
                        'task-hover': '0 4px 12px rgba(0, 0, 0, 0.12)',
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .task-complete {
                @apply line-through text-gray-400 transition-all duration-300;
            }
            .task-incomplete::before {
                content: '';
                @apply inline-block w-2 h-2 bg-accent rounded-full mr-2 animate-pulse;
            }
            .gradient-bg {
                background: linear-gradient(135deg, #EEF2FF 0%, #F9FAFB 100%);
            }
            .card-hover {
                @apply transition-all duration-300 hover:shadow-task-hover hover:-translate-y-1;
            }
            .input-focus {
                @apply focus:ring-2 focus:ring-primary/30 focus:border-primary focus:outline-none transition-all duration-200;
            }
        }
    </style>
</head>
<body class="font-inter min-h-screen gradient-bg flex flex-col">
    <header class="w-full py-6 px-4 md:px-8 bg-white/80 backdrop-blur-sm shadow-sm">
        <div class="max-w-6xl mx-auto">
            <h1 class="text-[clamp(1.75rem,3vw,2.5rem)] font-bold text-gray-800">
                <i class="fa fa-check-square-o mr-2 text-primary"></i>待办事项管理
            </h1>
            <p class="text-gray-500 mt-1">轻松管理您的日常任务，提高工作效率</p>
        </div>
    </header>

    <main class="flex-grow w-full px-4 md:px-8 py-8">
        <div class="max-w-6xl mx-auto bg-white rounded-xl shadow-md overflow-hidden transform transition-all duration-500 hover:shadow-lg">
            <div class="flex flex-col md:flex-row">
                <!-- 左侧：添加任务区域 -->
                <div class="p-6 md:p-8 border-b md:border-b-0 md:border-r border-gray-100 w-full md:w-1/3 bg-gray-50">
                    <h2 class="text-xl font-semibold text-gray-700 mb-4 flex items-center">
                        <i class="fa fa-plus-circle text-primary mr-2"></i>添加新任务
                    </h2>
                    <form id="addTaskForm" class="space-y-4">
                        <div class="transform transition-all duration-300 hover:scale-[1.01]">
                            <label for="taskTitle" class="block text-sm font-medium text-gray-700 mb-1">任务标题 <span class="text-accent">*</span></label>
                            <input type="text" id="taskTitle" 
                                class="w-full px-4 py-2.5 border border-gray-300 rounded-lg input-focus"
                                placeholder="输入任务标题..." required>
                        </div>
                        <div class="transform transition-all duration-300 hover:scale-[1.01]">
                            <label for="taskDescription" class="block text-sm font-medium text-gray-700 mb-1">任务描述</label>
                            <textarea id="taskDescription" rows="3" 
                                class="w-full px-4 py-2.5 border border-gray-300 rounded-lg input-focus"
                                placeholder="输入任务描述..."></textarea>
                        </div>
                        <div class="transform transition-all duration-300 hover:scale-[1.01]">
                            <label for="taskDueDate" class="block text-sm font-medium text-gray-700 mb-1">截止日期</label>
                            <input type="date" id="taskDueDate" 
                                class="w-full px-4 py-2.5 border border-gray-300 rounded-lg input-focus">
                        </div>
                        <button type="submit" id="addTaskButton"
                            class="w-full bg-primary hover:bg-primary/90 text-white font-medium py-2.5 px-4 rounded-lg transition-all duration-300 transform hover:scale-[1.02] flex items-center justify-center shadow-md hover:shadow-lg">
                            <i class="fa fa-plus mr-2"></i>添加任务
                        </button>
                    </form>
                </div>

                <!-- 右侧：任务列表区域 -->
                <div class="p-6 md:p-8 w-full md:w-2/3">
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4">
                        <h2 class="text-xl font-semibold text-gray-700 flex items-center">
                            <i class="fa fa-tasks text-primary mr-2"></i>任务列表
                        </h2>
                        <div class="flex space-x-2 self-stretch sm:self-auto">
                            <button id="filterAll" class="filter-btn px-3 py-1.5 rounded-md text-sm bg-primary text-white shadow-sm">全部</button>
                            <button id="filterActive" class="filter-btn px-3 py-1.5 rounded-md text-sm bg-gray-100 hover:bg-gray-200 transition-colors">未完成</button>
                            <button id="filterCompleted" class="filter-btn px-3 py-1.5 rounded-md text-sm bg-gray-100 hover:bg-gray-200 transition-colors">已完成</button>
                        </div>
                    </div>

                    <!-- 任务统计 -->
                    <div class="bg-gray-50 rounded-xl p-4 mb-6 shadow-sm grid grid-cols-3 gap-4">
                        <div class="text-center p-3 rounded-lg bg-white/50 transform transition-all duration-300 hover:scale-105">
                            <p class="text-sm text-gray-500">总任务数</p>
                            <p class="text-2xl font-bold text-gray-800" id="totalTasks">0</p>
                        </div>
                        <div class="text-center p-3 rounded-lg bg-white/50 transform transition-all duration-300 hover:scale-105">
                            <p class="text-sm text-gray-500">已完成</p>
                            <p class="text-2xl font-bold text-success" id="completedTasks">0</p>
                        </div>
                        <div class="text-center p-3 rounded-lg bg-white/50 transform transition-all duration-300 hover:scale-105">
                            <p class="text-sm text-gray-500">未完成</p>
                            <p class="text-2xl font-bold text-accent" id="pendingTasks">0</p>
                        </div>
                    </div>

                    <!-- 任务列表 -->
                    <div id="taskList" class="space-y-3 max-h-[calc(100vh-350px)] overflow-y-auto pr-2">
                        <!-- 任务项会通过JavaScript动态添加 -->
                        <div class="text-center text-gray-400 py-10" id="emptyTaskList">
                            <i class="fa fa-inbox text-4xl mb-3 block text-primary/30 animate-pulse"></i>
                            <p>暂无任务，请添加新任务</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="w-full py-4 px-4 md:px-8 bg-white/80 backdrop-blur-sm shadow-inner mt-8">
        <div class="max-w-6xl mx-auto text-center text-sm text-gray-500">
            <p>© 2025 待办事项管理应用 | 保持高效，轻松生活</p>
        </div>
    </footer>

    <script>
        // 任务数据存储
        let tasks = JSON.parse(localStorage.getItem('tasks')) || [];
        let currentFilter = 'all';

        // DOM元素
        const addTaskForm = document.getElementById('addTaskForm');
        const taskList = document.getElementById('taskList');
        const emptyTaskList = document.getElementById('emptyTaskList');
        const totalTasksElement = document.getElementById('totalTasks');
        const completedTasksElement = document.getElementById('completedTasks');
        const pendingTasksElement = document.getElementById('pendingTasks');
        const filterButtons = document.querySelectorAll('.filter-btn');
        const addTaskButton = document.getElementById('addTaskButton');

        // 初始化
        document.addEventListener('DOMContentLoaded', () => {
            renderTasks();
            updateTaskStats();
            
            // 过滤按钮事件
            document.getElementById('filterAll').addEventListener('click', () => setFilter('all'));
            document.getElementById('filterActive').addEventListener('click', () => setFilter('active'));
            document.getElementById('filterCompleted').addEventListener('click', () => setFilter('completed'));
            
            // 添加任务表单提交
            addTaskForm.addEventListener('submit', (e) => {
                e.preventDefault();
                addTask();
            });
            
            // 添加按钮点击事件（额外绑定确保兼容性）
            addTaskButton.addEventListener('click', (e) => {
                e.preventDefault();
                addTask();
            });
        });

        // 设置过滤器
        function setFilter(filter) {
            currentFilter = filter;
            filterButtons.forEach(btn => {
                btn.classList.remove('bg-primary', 'text-white', 'shadow-sm');
                btn.classList.add('bg-gray-100', 'hover:bg-gray-200');
            });
            
            const activeBtn = document.getElementById(`filter${filter.charAt(0).toUpperCase() + filter.slice(1)}`);
            activeBtn.classList.remove('bg-gray-100', 'hover:bg-gray-200');
            activeBtn.classList.add('bg-primary', 'text-white', 'shadow-sm');
            
            // 添加切换动画
            taskList.classList.add('opacity-0');
            setTimeout(() => {
                renderTasks();
                taskList.classList.remove('opacity-0');
            }, 200);
        }

        // 添加新任务
        function addTask() {
            const title = document.getElementById('taskTitle').value.trim();
            const description = document.getElementById('taskDescription').value.trim();
            const dueDate = document.getElementById('taskDueDate').value;
            
            if (!title) {
                // 添加输入错误提示
                const titleInput = document.getElementById('taskTitle');
                titleInput.classList.add('border-accent', 'animate-shake');
                setTimeout(() => {
                    titleInput.classList.remove('animate-shake');
                }, 500);
                return;
            }
            
            const newTask = {
                id: Date.now().toString(),
                title,
                description,
                dueDate,
                completed: false,
                createdAt: new Date().toISOString()
            };
            
            tasks.unshift(newTask); // 添加到数组开头
            saveTasks();
            
            // 添加任务动画
            taskList.classList.add('opacity-0');
            setTimeout(() => {
                renderTasks();
                updateTaskStats();
                taskList.classList.remove('opacity-0');
            }, 200);
            
            // 重置表单
            addTaskForm.reset();
            
            // 添加成功动画效果
            addTaskButton.classList.add('bg-success');
            addTaskButton.innerHTML = '<i class="fa fa-check mr-2"></i>添加成功';
            setTimeout(() => {
                addTaskButton.classList.remove('bg-success');
                addTaskButton.innerHTML = '<i class="fa fa-plus mr-2"></i>添加任务';
            }, 1000);
        }

        // 切换任务完成状态
        function toggleTaskStatus(taskId) {
            const taskElement = document.querySelector(`[data-task-id="${taskId}"]`);
            if (taskElement) {
                // 添加状态切换动画
                taskElement.classList.add('scale-95', 'opacity-50');
                
                setTimeout(() => {
                    tasks = tasks.map(task => {
                        if (task.id === taskId) {
                            return { ...task, completed: !task.completed };
                        }
                        return task;
                    });
                    
                    saveTasks();
                    renderTasks();
                    updateTaskStats();
                }, 200);
            }
        }

        // 删除任务
        function deleteTask(taskId) {
            const taskElement = document.querySelector(`[data-task-id="${taskId}"]`);
            if (taskElement) {
                // 添加删除动画
                taskElement.classList.add('scale-95', 'opacity-0', 'transform', 'translate-x-4');
                
                setTimeout(() => {
                    tasks = tasks.filter(task => task.id !== taskId);
                    saveTasks();
                    renderTasks();
                    updateTaskStats();
                }, 300);
            }
        }

        // 格式化日期
        function formatDate(dateString) {
            if (!dateString) return '无';
            const date = new Date(dateString);
            return date.toLocaleDateString('zh-CN', { year: 'numeric', month: 'long', day: 'numeric' });
        }

        // 检查是否过期
        function isOverdue(dueDateString) {
            if (!dueDateString) return false;
            const dueDate = new Date(dueDateString);
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            return dueDate < today;
        }

        // 保存任务到本地存储
        function saveTasks() {
            localStorage.setItem('tasks', JSON.stringify(tasks));
        }

        // 更新任务统计
        function updateTaskStats() {
            const total = tasks.length;
            const completed = tasks.filter(task => task.completed).length;
            const pending = total - completed;
            
            // 添加数字变化动画
            animateValue(totalTasksElement, parseInt(totalTasksElement.textContent), total, 500);
            animateValue(completedTasksElement, parseInt(completedTasksElement.textContent), completed, 500);
            animateValue(pendingTasksElement, parseInt(pendingTasksElement.textContent), pending, 500);
        }

        // 数字变化动画
        function animateValue(element, start, end, duration) {
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                element.textContent = Math.floor(progress * (end - start) + start);
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                }
            };
            window.requestAnimationFrame(step);
        }

        // 渲染任务列表
        function renderTasks() {
            // 过滤任务
            let filteredTasks = [...tasks];
            if (currentFilter === 'active') {
                filteredTasks = tasks.filter(task => !task.completed);
            } else if (currentFilter === 'completed') {
                filteredTasks = tasks.filter(task => task.completed);
            }
            
            // 清空列表
            taskList.innerHTML = '';
            
            // 检查是否有任务
            if (filteredTasks.length === 0) {
                taskList.appendChild(emptyTaskList);
                return;
            }
            
            // 添加任务项
            filteredTasks.forEach(task => {
                const taskElement = document.createElement('div');
                const overdue = !task.completed && isOverdue(task.dueDate);
                
                taskElement.className = `task-item p-4 bg-white rounded-xl shadow-task border-l-4 ${
                    task.completed ? 'border-success' : overdue ? 'border-accent' : 'border-primary'
                } transition-all duration-300 hover:shadow-task-hover card-hover`;
                taskElement.setAttribute('data-task-id', task.id);
                
                // 任务项内容
                taskElement.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex-1 min-w-0">
                            <div class="flex items-start">
                                <input type="checkbox" id="task-${task.id}" ${task.completed ? 'checked' : ''} 
                                    class="mt-1 h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded cursor-pointer transition-colors">
                                <label for="task-${task.id}" class="ml-3 block text-sm font-medium text-gray-700 ${task.completed ? 'task-complete' : 'task-incomplete'}">
                                    ${task.title}
                                    ${overdue ? '<span class="ml-2 text-xs bg-accent/10 text-accent px-2 py-0.5 rounded-full">已过期</span>' : ''}
                                </label>
                            </div>
                            ${task.description ? `
                                <p class="mt-1 text-sm text-gray-500 ${task.completed ? 'task-complete' : ''}">
                                    ${task.description}
                                </p>
                            ` : ''}
                            <div class="mt-2 flex flex-wrap items-center gap-x-4 gap-y-2 text-xs text-gray-500">
                                <span class="flex items-center">
                                    <i class="fa fa-calendar-o mr-1 ${task.completed ? 'text-gray-400' : overdue ? 'text-accent' : 'text-primary'}"></i>
                                    ${formatDate(task.dueDate)}
                                </span>
                                <span class="flex items-center">
                                    <i class="fa fa-clock-o mr-1 ${task.completed ? 'text-gray-400' : 'text-primary'}"></i>
                                    创建于 ${formatDate(task.createdAt)}
                                </span>
                            </div>
                        </div>
                        <div class="ml-4 flex-shrink-0 flex">
                            <button onclick="deleteTask('${task.id}')" class="text-gray-400 hover:text-accent focus:outline-none transition-colors">
                                <span class="sr-only">删除任务</span>
                                <i class="fa fa-trash-o text-lg"></i>
                            </button>
                        </div>
                    </div>
                `;
                
                // 添加复选框事件
                const checkbox = taskElement.querySelector(`#task-${task.id}`);
                checkbox.addEventListener('change', () => toggleTaskStatus(task.id));
                
                // 添加淡入动画
                taskElement.style.opacity = '0';
                taskElement.style.transform = 'translateY(10px)';
                taskList.appendChild(taskElement);
                
                // 触发动画
                setTimeout(() => {
                    taskElement.style.opacity = '1';
                    taskElement.style.transform = 'translateY(0)';
                }, 50);
            });
        }
    </script>
</body>
</html>
    